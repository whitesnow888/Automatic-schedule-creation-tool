'定数の設定
Const D_CNT = 43 '講習の日数
Const D_KOMA = 5 '一日のコマ数

Private Sub Worksheet_Activate()
    ピンクを戻す
    教科別残り空き数
    教師別残り空き数
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Dim sname As String
    Dim subject As String
    Dim grade As String
    Dim SH1 As Worksheet
    Dim SH3 As Worksheet
    Dim SH6 As Worksheet
    
    Set SH1 = Worksheets("講師教科")    'ワークシートを選択
    Set SH3 = Worksheets("全日程")    'ワークシートを選択
    Set SH6 = Worksheets("生徒入力用")    'ワークシートを選択
    
    If (((Target.row >= 4) And (Target.row <= SH6.Cells(1, 2) * 4)) And _
         ((Target.Column >= 3) And (Target.Column <= 33)) And _
         (Cells(Target.row, Target.Column) <> 0) And _
         (Cells(Target.row, Target.Column) <> "")) Then
    
        '選択されたセルの情報を取得する（たて、よこ）
        sname = Cells(Target.row, 2)
        subject = Cells(3, Target.Column)
        
        grade = 学年を調べる(Target.Column)
        '生徒の名前を保存
        SH3.Cells(2, 1) = sname
        
        'ピンクを戻す
        ピンクを戻す
        
        '日程が入れられるところはピンク色にする
        ピンクにする Target.row, Target.Column
        
        '名前を探してその時限のコマのピンクを戻す
        同日時同時限ピンクを戻す sname
    
        '名前を探してそのコマを赤色にする
        名前を赤にする sname
        
        '教科と名前を登録しておく　セル２，３に
        SH3.Cells(1, 3) = grade & subject & ") " & sname
              
        '選択されたセルの縦横を保存しておく
        SH3.Cells(1, 1) = Target.row
        SH3.Cells(1, 2) = Target.Column
        
        SH3.Activate
    
    End If
    
    If (((Target.row >= 4) And (Target.row <= SH6.Cells(1, 2) + 3)) And _
        (Target.Column = 2) And _
        (Cells(Target.row, 2) <> "")) Then
        SH3.Cells(3, 1) = Cells(Target.row, 2)
        SH3.Cells(4, 1) = Cells(Target.row, 1)
        名前を赤にする Cells(Target.row, 2)
        SH3.Activate
    End If
    
    If ((Target.row = 3) And ((Target.Column >= 3) And (Target.Column <= 33))) Then
        SH3.Cells(5, 1) = 学年を調べる(Target.Column) & Cells(Target.row, Target.Column)
        名前を赤にする SH3.Cells(5, 1)
        SH3.Cells(5, 1) = ""
        SH3.Activate
    End If

End Sub
